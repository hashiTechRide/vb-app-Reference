# はじめに
## 開発環境
- 開発対象: `.NET Framework4.8`
- 開発言語: `VB.NET`

## 1. **Microsoft公式ドキュメント**

### .NET Framework基礎
- **Microsoft Docs (.NET Framework)**
  - https://docs.microsoft.com/ja-jp/dotnet/framework/
  - .NET Frameworkの全体像

- **.NET API Browser**
  - https://docs.microsoft.com/ja-jp/dotnet/api/
  - すべての.NET APIのリファレンス
  - 例：`System.ComponentModel.Design` で検索

### Windows Formsデザイナー関連
- **Windows Forms Designer ドキュメント**
  - https://docs.microsoft.com/ja-jp/dotnet/desktop/winforms/controls/
  - コントロールとデザイナーの基礎

- **デザイン時サポートの拡張**
  - https://docs.microsoft.com/ja-jp/dotnet/framework/winforms/controls/developing-custom-windows-forms-controls
  - カスタムコントロールとデザイナーの作成方法

## 2. **重要な名前空間とクラス**

### デザイナー関連
```
System.ComponentModel.Design 名前空間
├── IDesigner インターフェース
├── DesignerActionList クラス (スマートタグ)
├── DesignerActionItem クラス
└── IDesignerHost インターフェース

System.Windows.Forms.Design 名前空間
├── ControlDesigner クラス
├── ParentControlDesigner クラス
├── DocumentDesigner クラス
└── ScrollableControlDesigner クラス

System.ComponentModel 名前空間
├── IExtenderProvider インターフェース
├── Component クラス
├── TypeDescriptor クラス
└── 各種属性 (Category, Description, DefaultValue等)
```

### 各クラスのリファレンスURL
- **ControlDesigner**
  - https://docs.microsoft.com/ja-jp/dotnet/api/system.windows.forms.design.controldesigner

- **IExtenderProvider**
  - https://docs.microsoft.com/ja-jp/dotnet/api/system.componentmodel.iextenderprovider

- **DesignerActionList**
  - https://docs.microsoft.com/ja-jp/dotnet/api/system.componentmodel.design.designeractionlist

- **Win32 API**
  - https://learn.microsoft.com/ja-jp/windows/win32/

## 3. **学習におすすめの書籍**

### 日本語書籍
- **「プログラミング .NET Framework 第4版」** (Jeffrey Richter著)
  - .NET Frameworkの内部動作を理解

https://amzn.asia/d/7a35Bl0

### 英語書籍（より詳細）
- **"Programming Windows Forms with C#"** (Charles Petzold)
  - Windows Formsの深い理解（VB.NETにも応用可能）

https://amzn.asia/d/1MojlGt

- **"Windows Forms 2.0 Programming"** (Chris Sells, Michael Weinhardt)
  - カスタムコントロールとデザイナーの詳細

https://amzn.asia/d/dnCeep6

- **"Windows Forms in Action: Second Edition of Windows Forms Programming with C#"** (Erik Brown)
  - Windows Formsの深い理解（VB.NETにも応用可能）

https://amzn.asia/d/9xVyMC7

## 4. **実践的な学習方法**

### 既存コントロールのソースを読む
.NET Frameworkのソースコードを参照：
- **Reference Source**
  - https://referencesource.microsoft.com/
  - 実際のWindows Formsコントロールの実装が見られる
  
例えば以下を検索して学習：
- `ErrorProvider` - IExtenderProviderの実装例
- `Panel` - シンプルなコンテナコントロール
- `SplitContainer` - 複雑なコンテナコントロール
- `ToolStrip` - 高度なカスタムデザイナー実装

### デコンパイルツールの活用
- **ILSpy** (無料)
  - https://github.com/icsharpcode/ILSpy
  - .NET アセンブリを逆コンパイルしてコードを確認

- **dnSpy** (無料)
  - https://github.com/dnSpy/dnSpy
  - デバッグ機能付き逆コンパイラ

使い方：
```
System.Windows.Forms.dll
└── System.Windows.Forms.Design.dll を開く
    └── ControlDesigner などのクラスを確認
```

## 5. **重要な属性とその使い方**

### デザイン時属性
```vb
' コントロールにデザイナーを関連付け
<Designer(GetType(MyControlDesigner))>

' プロパティを拡張
<ProvideProperty("PropertyName", GetType(Control))>

' カテゴリ分け
<Category("外観")>

' 説明文
<Description("このプロパティの説明")>

' デフォルト値
<DefaultValue(True)>

' シリアライズ方法
<DesignerSerializationVisibility(DesignerSerializationVisibility.Content)>

' プロパティの表示/非表示
<Browsable(False)>

' エディタの指定
<Editor(GetType(ColorEditor), GetType(UITypeEditor))>
```

## 6. **コミュニティとフォーラム**

### 日本語リソース
- **Qiita (VB.NET タグ)**
  - https://qiita.com/tags/vb.net
  - 日本語の技術記事

- **teratail**
  - https://teratail.com/
  - 日本語Q&Aサイト

### 英語リソース
- **Stack Overflow**
  - https://stackoverflow.com/questions/tagged/winforms+designer
  - タグ：`winforms`, `designer`, `vb.net`

- **Microsoft Q&A**
  - https://docs.microsoft.com/ja-jp/answers/
  - Microsoft公式のQ&Aプラットフォーム

## 7. **実践プロジェクト案**

段階的に学習するためのプロジェクト：

### レベル1：基本
1. シンプルなカスタムコントロール（色が変わるボタン）
2. プロパティにカテゴリと説明を追加
3. デフォルト値の設定

### レベル2：中級
1. スマートタグ（DesignerActionList）の実装
2. IExtenderProviderの実装（ToolTip風）
3. カスタムエディタの作成

### レベル3：上級
1. 複雑なコンテナコントロール
2. デザイン時の子コントロール操作
3. カスタムシリアライザの実装

## 8. **デバッグとトラブルシューティング**

### デザイナーのデバッグ方法
1. Visual Studioの2つ目のインスタンスを起動
2. デザイナープロジェクトをデバッグ実行
3. もう一方のVSでデザイナーを開く
4. ブレークポイントでデバッグ

### よくある問題の解決
- **Microsoft Docs - Windows Forms トラブルシューティング**
  - https://docs.microsoft.com/ja-jp/troubleshoot/dotnet/framework/

## 学習の進め方

1. **公式ドキュメントを読む** → 概念を理解
2. **Reference Sourceで実装を見る** → 実際のコードを学ぶ
3. **小さなプロジェクトで実践** → 手を動かす
4. **既存コントロールを改造** → 応用力をつける
5. **コミュニティで質問・共有** → 知識を深める

特に、Reference Source（referencesource.microsoft.com）は実際のMicrosoftのコードが見られるので非常に有用です。ErrorProviderやToolTipなどのIExtenderProvider実装を読むと、前々回作成したDesignTokenManagerの理解が深まります。
